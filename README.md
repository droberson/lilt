I did not write this. This came from the book Building Open Source Network
Security Tools. I have changed some of the formatting and fixed some minor
typos.

The original source code can still be found on the book's companion website.

I have posted this code for reference/academic reasons.
